<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>生成盒子上升</title>
		<style type="text/css">
			.box {
				width: 500px;
				height: 500px;
				border: 1px solid #6495ED;
				position: relative;
				top: 50px;
				left: 20%;
				background-color: white;
				overflow: hidden;
			}

			#small {
				width: 50px;
				height: 50px;
				border: 1px solid #FF4500;
				position: absolute;
				background-color: #9932CC;
			}

			div {
				width: 50px;
				height: 50px;
				position: absolute;
			}
		</style>
	</head>
	<body>
		<div class="box">
			<div id="small" style="position: absolute;"></div>
		</div>
	</body>
	<script type="text/javascript">
		window.onload = function() {
			var box = document.getElementsByClassName("box")[0];
			var small = document.getElementById("small");
			var left = false;
			var right = false;
			var top = false;
			var bottom = false;
			var x = false;
			document.onkeydown = function() {
				var key = event.charCode || event.keyCode || event.witch;
				event.preventDefault() //清除浏览器事件
				switch (key) {
					case 37:
						left = true;
						break;
					case 38:
						top = true;
						break;
					case 39:
						right = true;
						break;
					case 40:
						bottom = true;
						break;
					case 88:
						x = true;
						break;
					default:
						alert("请按上下左右键");
						break;
				}
			}
			setInterval(function() {
				if (left && small.offsetLeft > 0) {
					small.style.left = small.offsetLeft - 10 + "px";
				} else if (right && small.offsetLeft < 450) {
					small.style.left = small.offsetLeft + 10 + "px";
				}
				if (top && small.offsetTop > 0) {
					small.style.top = small.offsetTop - 10 + "px";
				} else if (bottom && small.offsetTop < 450) {
					small.style.top = small.offsetTop + 10 + "px";
				}
				if (x) {
					auto();
				}
			}, 100)


			document.onkeyup = function() {
				var key = event.charCode || event.keyCode || event.witch;
				event.preventDefault() //清除浏览器事件
				switch (key) {
					case 37:
						left = false;
						break;
					case 38:
						top = false;
						break;
					case 39:
						right = false;
						break;
					case 40:
						bottom = false;
						break;
					case 88:
						x = false;
						break;
					default:
						alert("请按上下左右键");
						break;
				}
			}

			function auto() {
				var newbox = document.createElement("div");
				newbox.style.backgroundColor = "rgb(" + Math.floor(Math.random() * 256) + "," + Math.floor(Math.random() * 256) +
					"," + Math.floor(Math.random() * 256) + "," + Math.floor(Math.random() * 256) + ")"; //随机背景色
				box.appendChild(newbox);
				newbox.style.top = parseInt(small.style.top) - 50 + "px";
				if(small.style.top==0){
					box.removeChild(newbox);
				}
				newbox.style.left = small.style.left;
				var move = null;
				move = setInterval(function() {
					newbox.style.top = parseInt(newbox.style.top) -1 + "px";
					if (parseInt(newbox.style.top) < -50) {
						clearInterval(move);
						box.removeChild(newbox);
					}
				}, 1 )
			}
		}
	</script>
</html>
